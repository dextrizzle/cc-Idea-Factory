<% if current_user %>
  <% @user = User.find(@idea.user_id) %>

  <h4><%= @user.email %></h4>
<% end %>

<h1><%= @idea.title %></h1>
<h3><%= @idea.text %></h3>

<br>
<% if current_user%>
    <% if @user == current_user %>
        <%= link_to 'Edit', edit_idea_path(@idea) %>
        <%= link_to 'Destroy', idea_path(@idea), method: :delete, data: { confirm: 'Are you sure?' } %>
    <% end %>
<% end %>


<hr>
<h2>Reviews</h2>
<hr>
<% @idea.reviews.each do |review| %>
    <p>
      <strong>Reviewer:</strong>
      <%= review.user_id %>
    </p>

    <p>
      <strong>Review:</strong>
      <%= review.body %>
    </p>
    <% if current_user %>
        <%if review.user_id == current_user.id%>
          <p>
            <%= link_to 'Destroy Review', [review.idea, review],
                        method: :delete,
                        data: {confirm: 'Are you sure?'} %>
          </p>
        <% end %>
    <% end %>
    <hr>
<% end %>

<% if current_user %>
  <h2>Add a review:</h2>
  <%= form_for([@idea, @idea.reviews.build]) do |f| %>
      <p>
        <%= f.label :body %><br>
        <%= f.text_area :body %>
      </p>
      <p>
        <%= f.submit %>
      </p>
  <% end %>
<% end %>

<%= link_to 'Back', ideas_path %>